lower = c(0,0,0,0))
R100084Rep1.bar_LM
# Subset data
R100084Rep2 <- subset(data3, Isolate == "R10-0084" & Rep =="2")
plot(R100084Rep2$t,R100084Rep2$LOG10N)
# Fit Baranyi
R100084Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100084Rep2,
start=list (
LOG10N0 = 3,
lag = 8,
mumax = 0.09734,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R100084Rep3 <- subset(data3, Isolate == "R10-0084" & Rep =="3")
plot(R100084Rep3$t,R100084Rep3$LOG10N)
# Fit Baranyi
R100084Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100084Rep3,
start=list (
LOG10N0 = 3,
lag = 8,
mumax = 0.09734,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R100990Rep1 <- subset(data3, Isolate == "R10-0990" & Rep =="1")
plot(R100990Rep1$t,R100990Rep1$LOG10N)
mod <- lm(R100990Rep1$LOG10N[6:10] ~ R100990Rep1$t[6:10])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R100990Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100990Rep1,
start=list (
LOG10N0 = 3,
lag = 24,
mumax = 0.08924,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R100990Rep2 <- subset(data3, Isolate == "R10-0990" & Rep =="2")
plot(R100990Rep2$t,R100990Rep2$LOG10N)
# Fit Baranyi
R100990Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100990Rep2,
start=list (
LOG10N0 = 3,
lag = 24,
mumax = 0.08924,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R100990Rep3 <- subset(data3, Isolate == "R10-0990" & Rep =="3")
# Fit Baranyi
R100990Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100990Rep3,
start=list (
LOG10N0 = 3,
lag = 24,
mumax = 0.08924,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R103286Rep1 <- subset(data3, Isolate == "R10-3286" & Rep =="1")
plot(R103286Rep1$t,R103286Rep1$LOG10N)
mod <- lm(R103286Rep1$LOG10N[4:9] ~ R103286Rep1$t[4:9])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R103286Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R103286Rep1,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.11054,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R103286Rep2 <- subset(data3, Isolate == "R10-3286" & Rep =="2")
plot(R103286Rep2$t,R103286Rep2$LOG10N)
# Fit Baranyi
R103286Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R103286Rep2,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.11054,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R103286Rep3 <- subset(data3, Isolate == "R10-3286" & Rep =="3")
plot(R103286Rep3$t,R103286Rep3$LOG10N)
# Fit Baranyi
R103286Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R103286Rep3,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.11054,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
mod <- lm(R103286Rep3$LOG10N[4:8] ~ R103286Rep3$t[4:8])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R103286Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R103286Rep3,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.06088,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R102381Rep1 <- subset(data3, Isolate == "R10-2381" & Rep =="1")
plot(R102381Rep1$t,R102381Rep1$LOG10N)
mod <- lm(R102381Rep1$LOG10N[4:10] ~ R102381Rep1$t[4:10])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R102381Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R102381Rep1,
start=list (
LOG10N0 = 3,
lag = 12,
mumax =  0.09265,
LOG10Nmax = 7),
lower = c(0,0,0,0))
# Subset data
R102381Rep2 <- subset(data3, Isolate == "R10-2381" & Rep =="2")
plot(R102381Rep2$t,R102381Rep2$LOG10N)
# Fit Baranyi
R102381Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R102381Rep2,
start=list (
LOG10N0 = 3,
lag = 12,
mumax =  0.09265,
LOG10Nmax = 7),
lower = c(0,0,0,0))
# Subset data
R102381Rep3 <- subset(data3, Isolate == "R10-2381" & Rep =="3")
plot(R102381Rep3$t,R102381Rep3$LOG10N)
# Fit Baranyi
R102381Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R102381Rep3,
start=list (
LOG10N0 = 3,
lag = 12,
mumax =  0.09265,
LOG10Nmax = 7),
lower = c(0,0,0,0))
# Subset data
R100056Rep1 <- subset(data3, Isolate == "R10-0056" & Rep =="1")
plot(R100056Rep1$t,R100056Rep1$LOG10N)
mod <- lm(R100056Rep1$LOG10N[5:8] ~ R100056Rep1$t[5:8])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R100056Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100056Rep1,
start=list (
LOG10N0 = 3,
lag = 12,
mumax =  0.14487,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R100056Rep2 <- subset(data3, Isolate == "R10-0056" & Rep =="2")
plot(R100056Rep2$t,R100056Rep2$LOG10N)
# Fit Baranyi
R100056Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100056Rep2,
start=list (
LOG10N0 = 3,
lag = 12,
mumax =  0.14487,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R100056Rep3 <- subset(data3, Isolate == "R10-0056" & Rep =="3")
# Fit Baranyi
R100056Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100056Rep3,
start=list (
LOG10N0 = 3,
lag = 12,
mumax =  0.14487,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R100553Rep1 <- subset(data3, Isolate == "R10-0553" & Rep =="1")
plot(R100553Rep1$t,R100553Rep1$LOG10N)
mod <- lm(R100553Rep1$LOG10N[4:8] ~ R100553Rep1$t[4:8])
slope <- coef(mod) [2]
slope*2.303
R100553Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100553Rep1,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.07546,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R100553Rep2 <- subset(data3, Isolate == "R10-0553" & Rep =="2")
# Fit Baranyi
R100553Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100553Rep2,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.07546,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R100553Rep3 <- subset(data3, Isolate == "R10-0553" & Rep =="3")
# Fit Baranyi
R100553Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100553Rep3,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.07546,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R100531Rep3 <- subset(data3, Isolate == "R10-0531" & Rep =="1")
plot(R100531Rep1$t,R100531Rep1$LOG10N)
mod <- lm(R100553Rep1$LOG10N[4:8] ~ R100553Rep1$t[4:8])
# Subset data
R100531Rep1 <- subset(data3, Isolate == "R10-0531" & Rep =="1")
plot(R100531Rep1$t,R100531Rep1$LOG10N)
mod <- lm(R100531Rep1$LOG10N[5:13] ~ R100531Rep1$t[5:13])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R100531Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100531Rep1,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.07699,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R100531Rep2 <- subset(data3, Isolate == "R10-0531" & Rep =="2")
# Fit Baranyi
R100531Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100531Rep2,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.07699,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R100531Rep3 <- subset(data3, Isolate == "R10-0531" & Rep =="3")
# Fit Baranyi
R100531Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100531Rep3,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.07699,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R101099Rep1 <- subset(data3, Isolate == "R10-1099" & Rep =="1")
plot(R101099Rep1$t,R101099Rep1$LOG10N)
mod <- lm(R101099Rep1$LOG10N[3:12] ~ R101099Rep1$t[3:12])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R101099Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R101099Rep1,
start=list (
LOG10N0 = 3,
lag = 8,
mumax =  0.067439,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R101099Rep2 <- subset(data3, Isolate == "R10-1099" & Rep =="2")
# Fit Baranyi
R101099Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R101099Rep2,
start=list (
LOG10N0 = 3,
lag = 8,
mumax =  0.067439,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R101099Rep3 <- subset(data3, Isolate == "R10-1099" & Rep =="3")
# Fit Baranyi
R101099Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R101099Rep3,
start=list (
LOG10N0 = 3,
lag = 8,
mumax =  0.067439,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R100941Rep1 <- subset(data3, Isolate == "R10-0941" & Rep =="1")
plot(R100941Rep1$t,R100941Rep1$LOG10N)
mod <- lm(R100941Rep1$LOG10N[2:9] ~ R100941Rep1$t[2:9])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R100941Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100941Rep1,
start=list (
LOG10N0 = 3,
lag = 4,
mumax =  0.06724,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R100941Rep2 <- subset(data3, Isolate == "R10-0941" & Rep =="2")
# Fit Baranyi
R100941Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100941Rep2,
start=list (
LOG10N0 = 3,
lag = 4,
mumax =  0.06724,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R100941Rep3 <- subset(data3, Isolate == "R10-0941" & Rep =="3")
# Fit Baranyi
R100941Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100941Rep3,
start=list (
LOG10N0 = 3,
lag = 4,
mumax =  0.06724,
LOG10Nmax = 8),
lower = c(0,0,0,0))
# Subset data
R101587Rep1 <- subset(data3, Isolate == "R10-1587" & Rep =="1")
plot(R101587Rep1$t,R101587Rep1$LOG10N)
mod <- lm(R101587Rep1$LOG10N[3:7] ~ R101587Rep1$t[3:7])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R101587Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R101587Rep1,
start=list (
LOG10N0 = 4,
lag = 8,
mumax = 0.060438,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R101587Rep2 <- subset(data3, Isolate == "R10-1587" & Rep =="2")
# Fit Baranyi
R101587Rep2.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R101587Rep2,
start=list (
LOG10N0 = 4,
lag = 8,
mumax = 0.060438,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
# Subset data
R101587Rep3 <- subset(data3, Isolate == "R10-1587" & Rep =="3")
# Fit Baranyi
R101587Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R101587Rep3,
start=list (
LOG10N0 = 4,
lag = 8,
mumax = 0.060438,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
rm(list=ls())
# ppc growth data
data3 = read.csv("PPCRawGrowthData.csv")
knitr::opts_knit$set(root.dir = "C:/Users/sujun/Documents/GitHub/Combined-Spoilage-Model-App/Refit Primary Growth Model")
# load packages
library(nlsMicrobio)
library(minpack.lm)
# load primary growth models
source("UtilityFunctions_baranyi.R")
View(data3)
colnames(data_sporeformer)[1] <- "t"
colnames(data3)[1] <- "t"
data3
data3$LOG10N <- as.numeric(data3$LOG10N)
data3$Isolate
data3$LOG10N <- as.numeric(data3$LOG10N)
data3 <- data3[order(data3$Isolate),]
data3 <- na.omit(data3)
View(data3)
data3$Isolate <- trimws(data3$Isolate, "left")
data3 <- data3[order(data3$Isolate),]
data3 <- na.omit(data3)
View(data3)
# create a list of data frames, one for each isolate and rep
data_list <- split(data3, list(data3$Isolate, data3$Rep))
# ppc starting values
starting_values_ppc<-read.csv("Starting_value_ppc.csv")
head(starting_values_ppc)
colnames(starting_values_ppc)[1] <- "Isolate"
starting_values_ppc<-starting_values_ppc[order(starting_values_ppc$Isolate),]
starting_values_ppc
starting_values_ppc <-  trimws(starting_values_ppc$Isolate, "left")
starting_values_ppc<-starting_values_ppc[order(starting_values_ppc$Isolate),]
# ppc starting values
starting_values_ppc<-read.csv("Starting_value_ppc.csv")
colnames(starting_values_ppc)[1] <- "Isolate"
starting_values_ppc <-  trimws(starting_values_ppc$Isolate, "left")
starting_values_ppc<-starting_values_ppc[order(starting_values_ppc$Isolate),]
starting_values_ppc
starting_values_ppc<-read.csv("Starting_value_ppc.csv")
starting_values_ppc
colnames(starting_values_ppc)[1] <- "Isolate"
starting_values_ppc$Isolate
starting_values_ppc <-  trimws(starting_values_ppc$Isolate, "left")
starting_values_ppc$Isolate
starting_values_ppc
data3$Isolate
# ppc starting values
starting_values_ppc<-read.csv("Starting_value_ppc.csv")
colnames(starting_values_ppc)[1] <- "Isolate"
starting_values_ppc$Isolate <-  trimws(starting_values_ppc$Isolate, "left")
starting_values_ppc<-starting_values_ppc[order(starting_values_ppc$Isolate),]
View(starting_values_ppc)
View(data3)
# initialize a list to store the fits
fit_list <- list()
# loop over each sample and its repetitions
for (i in 1:length(data_list)) {
# subset the data for the current sample and rep
sub_data <- data_list[[i]]
# extract the sample and rep information
isolate <- unique(sub_data$Isolate)
rep <- unique(sub_data$Rep)
# set the starting values for the current isolate and rep
start_values <- c(LOG10N0 = starting_values_ppc$LOG10N0[i],
lag = starting_values_ppc$lag[i],
mumax = starting_values_ppc$mumax[i],
LOG10Nmax = starting_values_ppc$LOG10Nmax[i])
# fit the Baranyi model to the subset of data
fit <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax),
data=sub_data,
start = start_values,
lower = c(0,0,0,0))
# extract the model coefficients
coef_values <- coefficients(fit)
# add the fit and its summary to the fit list
fit_list[[i]] <- data.frame(isolate=isolate, rep=rep,
LOG10N0 = coef_values["LOG10N0"],
lag = coef_values["lag"],
mumax = coef_values["mumax"],
LOG10Nmax = coef_values["LOG10Nmax"])
}
# combine the fits into a single data frame
fits_ppc <- do.call(rbind, fit_list)
write.csv(fits_ppc,"ppc_gp.csv")
# Load packages
library(nlsMicrobio)
library(minpack.lm)
# PPC
data3 = read.csv("PPCRawGrowthData.csv")
data3 = na.omit(data3)
colnames(data3)[1] = "t"
data3$LOG10N <- as.numeric(data3$LOG10N)
# Load primary growth models
source("UtilityFunctions_baranyi.R")
# Subset data
R100553Rep3 <- subset(data3, Isolate == "R10-0553" & Rep =="1")
# Subset data
R100553Rep1 <- subset(data3, Isolate == "R10-0553" & Rep =="1")
plot(R100553Rep1$t,R100553Rep1$LOG10N)
mod <- lm(R100553Rep1$LOG10N[4:9] ~ R100553Rep1$t[4:9])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R100553Rep1.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R100553Rep1,
start=list (
LOG10N0 = 3,
lag = 12,
mumax = 0.06999758 ,
LOG10Nmax = 7.5),
lower = c(0,0,0,0))
R100553Rep1.bar_LM
# Subset data
R100553Rep2 <- subset(data3, Isolate == "R10-0553" & Rep =="2")
plot(R100553Rep2$t,R100553Rep2$LOG10N)
# Subset data
R100553Rep3 <- subset(data3, Isolate == "R10-0553" & Rep =="3")
plot(R100553Rep3$t,R100553Rep3$LOG10N)
# Subset data
R100990Rep1 <- subset(data3, Isolate == "R10-0990" & Rep =="1")
plot(R100990Rep1$t,R100990Rep1$LOG10N)
# Subset data
R100990Rep2 <- subset(data3, Isolate == "R10-0990" & Rep =="2")
plot(R100990Rep2$t,R100990Rep2$LOG10N)
# Subset data
R100990Rep3 <- subset(data3, Isolate == "R10-0990" & Rep =="3")
plot(R100990Rep3$t,R100990Rep3$LOG10N)
# Subset data
R101181Rep1 <- subset(data3, Isolate == "R10-1181" & Rep =="1")
plot(R101181Rep1$t,R101181Rep1$LOG10N)
# Subset data
R101181Rep2 <- subset(data3, Isolate == "R10-1181" & Rep =="2")
plot(R101181Rep2$t,R101181Rep2$LOG10N)
# Subset data
R101181Rep3 <- subset(data3, Isolate == "R10-1181" & Rep =="3")
plot(R101181Rep3$t,R101181Rep3$LOG10N)
# Subset data
R101587Rep1 <- subset(data3, Isolate == "R10-1587" & Rep =="1")
plot(R101587Rep1$t,R101587Rep1$LOG10N)
# Subset data
R101587Rep2 <- subset(data3, Isolate == "R10-1587" & Rep =="2")
plot(R101587Rep2$t,R101587Rep2$LOG10N)
# Subset data
R101587Rep3 <- subset(data3, Isolate == "R10-1587" & Rep =="3")
plot(R101587Rep3$t,R101587Rep3$LOG10N)
plot(R103286Rep3$t,R103286Rep3$LOG10N)
# Subset data
R103286Rep3 <- subset(data3, Isolate == "R10-3286" & Rep =="3")
plot(R103286Rep3$t,R103286Rep3$LOG10N)
mod <- lm(R103286Rep3$LOG10N[4:7] ~ R103286Rep1$t[4:7])
mod <- lm(R103286Rep3$LOG10N[4:7] ~ R103286Rep3$t[4:7])
slope <- coef(mod) [2]
slope*2.303
# Fit Baranyi
R103286Rep3.bar_LM <- nlsLM(LOG10N ~ baranyi_log10N(t,lag,mumax,LOG10N0,LOG10Nmax), data=R103286Rep3,
start=list (
LOG10N0 = 4,
lag = 12,
mumax = 0.07931,
LOG10Nmax = 8),
lower = c(0,0,0,0))
rm(list=ls())
